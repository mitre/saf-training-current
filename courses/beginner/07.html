<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.10" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/saf-training-current/courses/beginner/07.html"><meta property="og:site_name" content="MITRE SAF Training"><meta property="og:title" content="7. InSpec Control Enhancements"><meta property="og:description" content="InSpec Control Enhancements You should have the basic idea of how an InSpec test is written and how to leverage InSpec's built-in features to help you write tests quickly and ea..."><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="article:author" content="Aaron Lippold"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"7. InSpec Control Enhancements","image":[""],"dateModified":null,"author":[{"@type":"Person","name":"Aaron Lippold"}]}</script><title>7. InSpec Control Enhancements | MITRE SAF Training</title><meta name="description" content="InSpec Control Enhancements You should have the basic idea of how an InSpec test is written and how to leverage InSpec's built-in features to help you write tests quickly and ea...">
    <link rel="preload" href="/saf-training-current/assets/style-cd0MrODX.css" as="style"><link rel="stylesheet" href="/saf-training-current/assets/style-cd0MrODX.css">
    <link rel="modulepreload" href="/saf-training-current/assets/app-WeARUK1X.js"><link rel="modulepreload" href="/saf-training-current/assets/07.html-qe07zN2f.js"><link rel="modulepreload" href="/saf-training-current/assets/07.html-BZGcNfMe.js"><link rel="modulepreload" href="/saf-training-current/assets/plugin-vue_export-helper-x3n3nnut.js">
    <link rel="prefetch" href="/saf-training-current/assets/index.html-IUjjcXGY.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/slides.html-OUi9CvUw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-4ZA9cCym.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/disable.html-aatkKhWa.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/encrypt.html-Ciea4rOp.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/markdown.html-4D6TgJ2U.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/page.html-LR-aF7zN.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-QldYRTF3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/LinuxInstall.html-UhGzkZSg.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/MacInstall.html-eCq0xq_9.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-4J8LIlOz.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/WindowsInstall.html-RGWWc2jw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-Pk5uT44Z.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-eiiFfcvy.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-bhoQajFy.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-yU9X6puA.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-s8b_Tjfz.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-nHEMmPLa.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-aQuLNCc3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-PxwMIIPj.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-cAYHScL7.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-cVN0xw1G.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-F6h-tJHN.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-ubCrsSiZ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-3w9gZhwu.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-lU2XdtZP.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-C9_dgWCC.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix A - Writing Plural Resources.html-r3boAVkk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix B - Resource Examples.html-QXsRSFWg.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix C - Adding Your Resource to InSpec.html-OD69WsIT.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix D - Example Pipeline for Validating an InSpec Profile.html-oYaMajmi.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix E - More Resource Examples.html-Em2RiKLE.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-2LV9VbKo.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-JshwEYFJ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-eLsIz6GP.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-DjpH7fqL.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-JMlWHQiw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-ERSvBiWc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-JuLMcci3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-oOr1_HZY.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-6Jg2JV5N.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-R9g9WDBh.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-VebfdAEk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-18TYrGYo.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-v6MPPITE.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-cnXF-Q-a.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-O509s8ep.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-HcTM7tzw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-ru8nVPea.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html--thaQQpk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-Bj8P3WNy.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-sr9P6hcc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-mE7bYKrj.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-xJSqyI2k.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-p-bV4GEe.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-p42ny8r4.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-pv9RMZKF.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-bCYNtWGJ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-SXJtdpfZ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-bE9J7A0m.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-hdNMcAbp.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-q1l4z5gg.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-xcJN8qMs.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-e38Kc56i.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-3jfrKfx4.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-mKS5au3V.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-Mdis-p02.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-QWEzujLD.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-Wd68h4sP.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-Zji7hdCB.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/14.html-uhh8xU8e.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/15.html-Dh_jLCXt.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/16.html-Tnf2Vygp.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/17.html-Y7iITvEd.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/18.html-ocO78wuF.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/19.html-H9RGuU9S.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/20.html-lVZ2Xc0L.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/21.html-NxKx8Pfw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/22.html-1AvSYw9s.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/23.html-cVswea4X.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/24.html-zXhokNRn.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/25.html-k5LZ7gb2.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/26.html-hIXZUpRw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/27.html-UAAMrzqr.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/28.html-AexiCpa-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-HVFpGKkQ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-eIH8zqow.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-cA253RC4.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-9IKgrxkD.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-8TAbwTjt.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-1wROJA7x.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-5kRm4-3h.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-M6IvW3of.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-SeF1OFVe.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-t60GgQNo.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-XUz2uHv-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-ERHnP5wQ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-HslrlGDz.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/14.html-oERznQ2b.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/15.html-lasSbwk6.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/16.html-pLB13GOU.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-qAmOgfe6.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-Q9s73PgV.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/baz.html-8gf2rMdO.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-66E39eeh.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/ray.html-MJY6f4Mm.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/404.html-vogUaTe9.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-0BR3vi_S.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-ZsdVHE7P.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/slides.html-7kKt8J3R.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-PdxZqMdy.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/disable.html-oFntHThB.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/encrypt.html-PNHS4Ioc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/markdown.html-sCk1ZWsT.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/page.html-vC6JGNSj.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-zYT5m4TV.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/LinuxInstall.html-YZQSnyIk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/MacInstall.html-_q-ezVdQ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-aVK2HALn.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/WindowsInstall.html-1yYSjgl-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-W7TuYxQi.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-fMZ41dM2.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-tn94G7TE.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-qo_cSaEw.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-l3jNFbFl.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-UdjMA7ZT.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-zuQebxu5.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-EM_zp7kB.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-Pp3Bvg_1.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-Jve-TBmB.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-QSJZvBB0.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-kgWVNY9J.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-S70xJVCY.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-5dPRkMH3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-gmqhkm1U.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix A - Writing Plural Resources.html-296LN7xc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix B - Resource Examples.html-4DvV_3Z8.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix C - Adding Your Resource to InSpec.html-GPcCWcSg.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix D - Example Pipeline for Validating an InSpec Profile.html-opV10Ru_.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/Appendix E - More Resource Examples.html-oKp3S78c.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-oRktPNx3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-Vt9KS5kl.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html--fWHWqnr.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-8z5RRL4-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-gixE0V6D.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-QfpjCiYA.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-e0y1Hctc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-wO6PoO_r.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-4j5QHJOb.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-Ag9BdDgG.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-rsd8JmHj.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-bj_fw55y.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-JktULioM.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-ki889mHf.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-Ge-HyqvM.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-XpvLQhDv.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-nMX1poAe.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-6TgQyIDk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-wZiGJ9x3.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-fs4GTO90.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-tJp4LN-M.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-OZp8lKx-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-W_DAz23s.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-z_7F5VTn.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-PbJo8M57.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-zNf7CxMr.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-06qZPay-.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-0yq1d5Cf.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-YaJFQdam.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-89-uCbwZ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-3plWAyse.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-oPtYzb00.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-4H5knf0d.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-awgNQP0j.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-PdBvpLRZ.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-F5IIeVi4.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-aFRj6U8w.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-bbhR6CDa.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/14.html-QlCx29sm.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/15.html-VcZSad8O.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/16.html-zkT9KWYD.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/17.html-_UsP8cKm.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/18.html-VbXKkEsb.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/19.html-TzlELRIU.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/20.html-jZ7eHbkI.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/21.html-GgC8PZRc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/22.html-enCtJOK7.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/23.html-CoiKF9tP.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/24.html-_FBuPsSf.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/25.html--ZoxmZn_.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/26.html-9A-Z6H98.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/27.html-jMKKF_rg.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/28.html--6u_E1cc.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-bU9llI3_.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/02.html-xQtWEIJv.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/03.html-vdOtrwIe.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/04.html-VbaL6oFE.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/05.html-t274I1Dm.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/06.html-2D9Rg8hy.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/07.html-CZg2c_wL.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/08.html-vIyiIEof.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/09.html-ifRa2g-8.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/10.html-CP4frmOE.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/11.html-jTMXpAhk.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/12.html-V4s1NZeW.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/13.html-0nJF05Pn.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/14.html-GGhkW8xn.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/15.html--BlVbFGN.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/16.html-Xx_J0HyM.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-AVhWW_6n.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-rIiczDDa.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/baz.html-2FTsRkyi.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-Pc8vuxMW.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/ray.html-RRGKZ5D8.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/404.html-8vV7bRmz.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/index.html-yXlQFL_m.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/giscus-08zh9c_o.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/mermaid.core-WQeQyS2H.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/reveal.esm-QxxCNeuR.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/markdown.esm-ldiezHYe.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/highlight.esm-qL7kkCul.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/math.esm--eqzfLue.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/search.esm-I_xTZtXh.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/notes.esm--_TQ5Wr4.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/zoom.esm-w3VbP3hY.js" as="script"><link rel="prefetch" href="/saf-training-current/assets/photoswipe.esm-08_zHRDQ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/saf-training-current/"><img class="vp-nav-logo" src="/saf-training-current/logo.svg" aria-hidden><!----><span class="vp-site-name hide-in-pad">MITRE SAF Training</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="MITRE SAF Training" class="vp-link nav-link nav-link" href="/saf-training-current/"><span class="font-icon icon iconfont icon-home" style=""></span>MITRE SAF Training<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="Classes"><span class="title"><span class="font-icon icon iconfont icon-lightbulb" style=""></span>Classes</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="SAF User Class" class="vp-link nav-link nav-link" href="/saf-training-current/courses/user/"><span class="font-icon icon iconfont icon-creative" style=""></span>SAF User Class<!----></a></li><li class="dropdown-item"><a aria-label="Beginner Security Automation Developer Class" class="vp-link nav-link active nav-link active" href="/saf-training-current/courses/beginner/"><span class="font-icon icon iconfont icon-creative" style=""></span>Beginner Security Automation Developer Class<!----></a></li><li class="dropdown-item"><a aria-label="Advanced Security Automation Developer Class" class="vp-link nav-link nav-link" href="/saf-training-current/courses/advanced/"><span class="font-icon icon iconfont icon-creative" style=""></span>Advanced Security Automation Developer Class<!----></a></li><li class="dropdown-item"><a aria-label="Security Guidance Developer Class" class="vp-link nav-link nav-link" href="/saf-training-current/courses/guidance/"><span class="font-icon icon iconfont icon-creative" style=""></span>Security Guidance Developer Class<!----></a></li><li class="dropdown-item"><a aria-label="InSpec Profile Development &amp; Testing" class="vp-link nav-link nav-link" href="/saf-training-current/courses/profile-dev-test.html"><span class="font-icon icon iconfont icon-creative" style=""></span>InSpec Profile Development &amp; Testing<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="Resources"><span class="title"><span class="font-icon icon iconfont icon-book" style=""></span>Resources</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="Class Resources" class="vp-link nav-link nav-link" href="/saf-training-current/resources/"><!---->Class Resources<!----></a></li><li class="dropdown-item"><a aria-label="Codespace Resources" class="vp-link nav-link nav-link" href="/saf-training-current/resources/02.html"><!---->Codespace Resources<!----></a></li><li class="dropdown-item"><a aria-label="Training Development Docs" class="vp-link nav-link nav-link" href="/saf-training-current/resources/03.html"><!---->Training Development Docs<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="Installation" class="vp-link nav-link nav-link" href="/saf-training-current/installation/"><span class="font-icon icon iconfont icon-note" style=""></span>Installation<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="MITRE SAF Training" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/"><span class="font-icon icon iconfont icon-home" style=""></span>MITRE SAF Training<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><a aria-label="User Class" class="vp-link nav-link vp-sidebar-title nav-link vp-sidebar-title" href="/saf-training-current/courses/user/"><!---->User Class<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">Beginner Class</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="Beginner Profile Development" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/"><!---->Beginner Profile Development<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="2. What is an InSpec Profile?" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/02.html"><!---->2. What is an InSpec Profile?<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="3. Study an InSpec Profile - NGINX Example" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/03.html"><!---->3. Study an InSpec Profile - NGINX Example<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="4. How to Get Started - InSpec Commands &amp; Docs" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/04.html"><!---->4. How to Get Started - InSpec Commands &amp; Docs<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="5. Writing InSpec Controls" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/05.html"><!---->5. Writing InSpec Controls<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="6. Inputs in InSpec" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/06.html"><!---->6. Inputs in InSpec<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="7. InSpec Control Enhancements" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/saf-training-current/courses/beginner/07.html"><!---->7. InSpec Control Enhancements<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="InSpec Control Enhancements" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#inspec-control-enhancements"><!---->InSpec Control Enhancements<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="RSpec" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#rspec"><!---->RSpec<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="RSpec Explicit Subject" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#rspec-explicit-subject"><!---->RSpec Explicit Subject<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="The should vs. expect syntax" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#the-should-vs-expect-syntax"><!---->The should vs. expect syntax<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="expect syntax with a failure message" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#expect-syntax-with-a-failure-message"><!---->expect syntax with a failure message<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Expect syntax and Password Hashes" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#expect-syntax-and-password-hashes"><!---->Expect syntax and Password Hashes<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Using Multiple Resources For One Test" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/saf-training-current/courses/beginner/07.html#using-multiple-resources-for-one-test"><!---->Using Multiple Resources For One Test<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="8. Generating InSpec Results" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/08.html"><!---->8. Generating InSpec Results<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="9. Viewing and Analyzing Results" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/09.html"><!---->9. Viewing and Analyzing Results<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="10. Profile Dependencies (Overlays)" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/10.html"><!---->10. Profile Dependencies (Overlays)<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="11. From STIG to Profile" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/11.html"><!---->11. From STIG to Profile<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="12. Put it in Practice!" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/12.html"><!---->12. Put it in Practice!<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="13. Next Steps" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/saf-training-current/courses/beginner/13.html"><!---->13. Next Steps<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">Advanced Class</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">Guidance Class</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-creative" style=""></span><span class="vp-sidebar-title">InSpec Profile Development &amp; Testing</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->7. InSpec Control Enhancements</h1><div class="page-info"><span class="page-author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Aaron Lippold</span></span><span property="author" content="Aaron Lippold"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 6 min</span><meta property="timeRequired" content="PT6M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#inspec-control-enhancements">InSpec Control Enhancements</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#rspec">RSpec</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#rspec-explicit-subject">RSpec Explicit Subject</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#the-should-vs-expect-syntax">The should vs. expect syntax</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#expect-syntax-with-a-failure-message">expect syntax with a failure message</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#expect-syntax-and-password-hashes">Expect syntax and Password Hashes</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#using-multiple-resources-for-one-test">Using Multiple Resources For One Test</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h2 id="inspec-control-enhancements" tabindex="-1"><a class="header-anchor" href="#inspec-control-enhancements" aria-hidden="true">#</a> InSpec Control Enhancements</h2><p>You should have the basic idea of how an InSpec test is written and how to leverage InSpec&#39;s built-in features to help you write tests quickly and easily. Now let&#39;s discuss some of the more powerful features available to you when writing tests to control what output is displayed to the user.</p><h3 id="rspec" tabindex="-1"><a class="header-anchor" href="#rspec" aria-hidden="true">#</a> RSpec</h3><p>The InSpec testing framework is itself built on <a href="https://rspec.info/" target="_blank" rel="noopener noreferrer">RSpec<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, a unit testing module for Ruby. InSpec extended rspec by including features like the resources library and more user-friendly syntax for writing tests, but we can still write our tests using RSpec syntax and they will work just fine.</p><p>Most of the time you won&#39;t need to use RSpec syntax to write a good test. But we want to show you a few neat tricks you can accomplish with RSpec.</p><h3 id="rspec-explicit-subject" tabindex="-1"><a class="header-anchor" href="#rspec-explicit-subject" aria-hidden="true">#</a> RSpec Explicit Subject</h3><p>We will write a few tests in this section to demonstrate the difference between InSpec&#39;s default syntax and RSpec syntax.</p><p>Let&#39;s pretend we have a new requirement for NGINX:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">6</span>. NGINX&#39;s /etc/nginx directory should not be empty.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>(It&#39;s a bit of an odd requirement, but bear with us for the sake of this example.)</p><p>First, we&#39;ll try a test that <em>does not</em> use RSpec syntax to illustrate the problem we want to solve:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-31-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-31-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-31-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">&#39;Requirement 6&#39;</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">&#39;Checking that /etc/nginx does not return empty&#39;</span></span>
  desc <span class="token string-literal"><span class="token string">&#39;Let\&#39;s do this the ugly way.&#39;</span></span>
  describe command<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;ls -al&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>strip <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should_not be_empty <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-31-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  ✔  Requirement <span class="token number">6</span>: Checking that /etc/nginx does not <span class="token builtin class-name">return</span> empty
     ✔  total <span class="token number">76</span>
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 <span class="token builtin class-name">.</span>
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 <span class="token punctuation">..</span>
     -rwxr-xr-x   <span class="token number">1</span> root root    <span class="token number">0</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 .dockerenv
     lrwxrwxrwx   <span class="token number">1</span> root root    <span class="token number">7</span> Oct <span class="token number">30</span> 00:00 bin -<span class="token operator">&gt;</span> usr/bin
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Sep <span class="token number">29</span> <span class="token number">20</span>:04 boot
     drwxr-xr-x   <span class="token number">5</span> root root  <span class="token number">360</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 dev
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">1</span> 05:12 docker-entrypoint.d
     -rwxrwxr-x   <span class="token number">1</span> root root <span class="token number">1620</span> Nov  <span class="token number">1</span> 05:11 docker-entrypoint.sh
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 etc
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Sep <span class="token number">29</span> <span class="token number">20</span>:04 home
     lrwxrwxrwx   <span class="token number">1</span> root root    <span class="token number">7</span> Oct <span class="token number">30</span> 00:00 lib -<span class="token operator">&gt;</span> usr/lib
     lrwxrwxrwx   <span class="token number">1</span> root root    <span class="token number">9</span> Oct <span class="token number">30</span> 00:00 lib32 -<span class="token operator">&gt;</span> usr/lib32
     lrwxrwxrwx   <span class="token number">1</span> root root    <span class="token number">9</span> Oct <span class="token number">30</span> 00:00 lib64 -<span class="token operator">&gt;</span> usr/lib64
     lrwxrwxrwx   <span class="token number">1</span> root root   <span class="token number">10</span> Oct <span class="token number">30</span> 00:00 libx32 -<span class="token operator">&gt;</span> usr/libx32
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 media
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 mnt
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 opt
     dr-xr-xr-x <span class="token number">228</span> root root    <span class="token number">0</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 proc
     drwx------   <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 root
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 run
     lrwxrwxrwx   <span class="token number">1</span> root root    <span class="token number">8</span> Oct <span class="token number">30</span> 00:00 sbin -<span class="token operator">&gt;</span> usr/sbin
     drwxr-xr-x   <span class="token number">2</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 srv
     dr-xr-xr-x  <span class="token number">12</span> root root    <span class="token number">0</span> Nov  <span class="token number">8</span> <span class="token number">20</span>:21 sys
     drwxrwxrwt   <span class="token number">1</span> root root <span class="token number">4096</span> Nov  <span class="token number">1</span> 05:12 tmp
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 usr
     drwxr-xr-x   <span class="token number">1</span> root root <span class="token number">4096</span> Oct <span class="token number">30</span> 00:00 var is expected not to be empty
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Well. . . it <em>sort of</em> works.</p><p>Notice how much output InSpec printed here to answer the simple question of &quot;did this command return empty?&quot; Imagine if we had done this on a directory with many files in it. We&#39;d just be cluttering up the screen (and our report files).</p><div class="hint-container warning"><p class="hint-container-title">Wait, couldn&#39;t we have just used the directory resource for this?</p><p>Correct. That would have been a much better way of doing this, and illustrates the general principle of &quot;don&#39;t use raw shell commands with the <code>command</code> resource unless you have to.&quot;</p><p>We&#39;re just doing it this way for the example.</p></div><p>If we would like to have a more detailed and cleaner feedback to our user, we can override the standard title of our describe block with a specific message that describes the intent of the test and use the <a href="https://relishapp.com/rspec/rspec-core/docs/subject/explicit-subject" target="_blank" rel="noopener noreferrer">Explicit Subject<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to tell inspec what the &quot;subject&quot; is for the test, then, we could refactor the code like this:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-56-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-56-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-56-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">&#39;Requirement 6&#39;</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">&#39;Checking that /etc/nginx does not return empty&#39;</span></span>
  desc <span class="token string-literal"><span class="token string">&#39;Let\&#39;s do this the concise way.&#39;</span></span>
  describe <span class="token string-literal"><span class="token string">&quot;The /etc/nginx directory&quot;</span></span> <span class="token keyword">do</span>
    subject <span class="token punctuation">{</span> command<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;ls -al&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>strip <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_empty <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-56-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  ✔  Requirement <span class="token number">6</span>: Checking that /etc/nginx does not <span class="token builtin class-name">return</span> empty
     ✔  The /etc/nginx directory is expected not to be empty
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Much better, right? We can override InSpec&#39;s default output to print a message that is actually useful.</p><div class="hint-container info"><p class="hint-container-title">Info</p><p>Another benefit to using <code>subject</code> is preventing command output from being stored in the report.</p></div><h3 id="the-should-vs-expect-syntax" tabindex="-1"><a class="header-anchor" href="#the-should-vs-expect-syntax" aria-hidden="true">#</a> The <code>should</code> vs. <code>expect</code> syntax</h3><p>Users familiar with the RSpec testing framework may know that there are two ways to write test statements: <code>should</code> and <code>expect</code>. The RSpec community decided that <code>expect</code> is the preferred syntax.</p><p>InSpec recommends the <code>should</code> syntax as it tends to read more easily. However, there are times when the <code>expect</code> syntax will communicate much more clearly to the end-user. InSpec will continue to support both methods of writing tests.</p><p>Let&#39;s copy the <code>describe</code> shown below directly into our <code>example.rb</code> file (we don&#39;t need to wrap them in a <code>control</code> block for this section). Consider this <code>describe</code> block from your <code>my_nginx</code> profile:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-84-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-84-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-84-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/etc/nginx/nginx.conf&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should be_file <span class="token punctuation">}</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-84-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>File /etc/nginx/nginx.conf
   ✔  should be a <span class="token function">file</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>This can be re-written with expect syntax.</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-95-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-95-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-95-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/etc/nginx/nginx.conf&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token string-literal"><span class="token string">&#39;should be a file&#39;</span></span> <span class="token keyword">do</span>
    expect<span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>be_file<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-95-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>File /etc/nginx/nginx.conf
   ✔  should be a <span class="token function">file</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Notice that the output is the same for both the examples above.</p><p>In addition, you can make use of the <code>subject</code> keyword to further control your output if you choose:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-109-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-109-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-109-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>describe <span class="token string-literal"><span class="token string">&#39;I can make this any string I want!&#39;</span></span> <span class="token keyword">do</span>
  subject <span class="token punctuation">{</span> file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/etc/nginx/nginx.conf&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  it <span class="token string-literal"><span class="token string">&#39;should be a file&#39;</span></span> <span class="token keyword">do</span>
    expect<span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">(</span>be_file<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-109-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  I can <span class="token function">make</span> this any string I want<span class="token operator">!</span>
     ✔  should be a <span class="token function">file</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><div class="hint-container info"><p class="hint-container-title">Info</p><p>Note that all three of the above code examples are running the same test that will pass or fail in the same circumstances — the difference is that the second two examples give more control over the message output that appears to the test performer. If you write tests that will later be executed by other people, you should be sure to write descriptive test output!</p></div><p>Reference: <a href="https://docs.chef.io/inspec/profiles/" target="_blank" rel="noopener noreferrer">https://docs.chef.io/inspec/profiles/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="expect-syntax-with-a-failure-message" tabindex="-1"><a class="header-anchor" href="#expect-syntax-with-a-failure-message" aria-hidden="true">#</a> <code>expect</code> syntax with a failure message</h3><p>In addition to using an <code>expect</code> statement, a failure message can be added to provide a meaningful output to the end user.</p><p>Consider this shell access test from your nginx profile:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-134-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-134-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-134-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>describe users<span class="token punctuation">.</span>shells<span class="token punctuation">(</span><span class="token regex-literal"><span class="token regex">/bash/</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>usernames <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should be_in input<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;admin_users&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-134-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  <span class="token punctuation">[</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">]</span>
     ×  is expected to be <span class="token keyword">in</span> <span class="token string">&quot;admin&quot;</span>
     expected <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">]</span><span class="token variable">`</span></span> to be <span class="token keyword">in</span> the list: <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token variable">`</span></span> 
     Diff:
      <span class="token punctuation">[</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Again, this is a valid test, and will return the right pass/fail answer when run, but it is difficult for a person to parse if they were not the author (&quot;The root user is supposed to be &#39;in&#39; the admin user? What does that mean?!&quot;).</p><p>The output of a test like this can be refined to provide a cleaner output to the user. This can be done using a custom failure message:</p><div class="vp-code-tabs"><div class="vp-code-tabs-nav" role="tablist"><button type="button" class="vp-code-tab-nav active" role="tab" aria-controls="codetab-148-0" aria-selected="true">Code</button><button type="button" class="vp-code-tab-nav" role="tab" aria-controls="codetab-148-1" aria-selected="false">Output</button></div><!--[--><div class="vp-code-tab active" id="codetab-148-0" role="tabpanel" aria-expanded="true"><div class="vp-code-tab-title">Code</div><!--[--><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>non_admin_users <span class="token operator">=</span> users<span class="token punctuation">.</span>shells<span class="token punctuation">(</span><span class="token regex-literal"><span class="token regex">/bash/</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>usernames
describe <span class="token string-literal"><span class="token string">&quot;Shell access for non-admin users&quot;</span></span> <span class="token keyword">do</span>
  it <span class="token string-literal"><span class="token string">&quot;should be removed.&quot;</span></span> <span class="token keyword">do</span>
    failure_message <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;These non-admin should not have shell access: </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">non_admin_users<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&quot;, &quot;</span></span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">&quot;</span></span>
    expect<span class="token punctuation">(</span>non_admin_users<span class="token punctuation">)</span><span class="token punctuation">.</span>to eq<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;admin_users&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> failure_message
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-code-tab" id="codetab-148-1" role="tabpanel" aria-expanded="false"><div class="vp-code-tab-title">Output</div><!--[--><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>  Shell access <span class="token keyword">for</span> non-admin <span class="token function">users</span>
     ×  should be removed.
     These non-admin should not have shell access: root
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>The <code>failure_message</code> variable in the above <code>describe</code> block is assigned a value by pure Ruby assignment. Remember how we said that, since InSpec is built on Ruby, any Ruby syntax will work inside an InSpec test? Ruby&#39;s string formatting syntax (the <code>#{non_admin_users.join(&quot;, &quot;)}</code>) can create a string that lists the users who fail the test by having shell access when they shouldn&#39;t.</p><div class="hint-container tip"><p class="hint-container-title">Writing good failure messages</p><p>The trick to writing useful failure messages is to use Ruby to find the <em>subset</em> of all elements we are testing (here, the users) that actually fail the test. We don&#39;t need to print a statement for <em>every array element we tested;</em> we only need to print a statement that shows the elements that failed.</p></div><h3 id="expect-syntax-and-password-hashes" tabindex="-1"><a class="header-anchor" href="#expect-syntax-and-password-hashes" aria-hidden="true">#</a> <code>Expect</code> syntax and Password Hashes</h3><p>Here&#39;s another example -- we have an InSpec test that checks if passwords are SHA512 hashes.</p><p>As we said, when possible, and when there is a high change of a large set only having a few offending items, attempt to find only those items that could be outside our requirements. If there are none -- wonderful! We met our requirement.</p><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>bad_users <span class="token operator">=</span> inspec<span class="token punctuation">.</span>shadow<span class="token punctuation">.</span>where <span class="token punctuation">{</span> password <span class="token operator">!=</span> <span class="token string-literal"><span class="token string">&quot;*&quot;</span></span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">!=</span> <span class="token string-literal"><span class="token string">&quot;!&quot;</span></span> <span class="token operator">&amp;&amp;</span> password <span class="token operator">!~</span> <span class="token regex-literal"><span class="token regex">/\$6\$/</span></span> <span class="token punctuation">}</span><span class="token punctuation">.</span>users <span class="token comment"># note that SHA12-encrypted passwords are marked by starting with &#39;$6$&#39; in /etc/shadow</span>

describe <span class="token string-literal"><span class="token string">&#39;Password hashes in /etc/shadow&#39;</span></span> <span class="token keyword">do</span>
  it <span class="token string-literal"><span class="token string">&#39;should only contain SHA512 hashes&#39;</span></span> <span class="token keyword">do</span>
    failure_message <span class="token operator">=</span> <span class="token string-literal"><span class="token string">&quot;Users without SHA512 hashes: </span><span class="token interpolation"><span class="token delimiter punctuation">#{</span><span class="token content">bad_users<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;, &#39;</span></span><span class="token punctuation">)</span></span><span class="token delimiter punctuation">}</span></span><span class="token string">&quot;</span></span>
    expect<span class="token punctuation">(</span>bad_users<span class="token punctuation">)</span><span class="token punctuation">.</span>to be_empty<span class="token punctuation">,</span> failure_message
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="using-multiple-resources-for-one-test" tabindex="-1"><a class="header-anchor" href="#using-multiple-resources-for-one-test" aria-hidden="true">#</a> Using Multiple Resources For One Test</h3><p>The <code>file</code> resource is perfect for looking at single files and their properties. However, it does not look at <em>groups</em> of files. To do that, we need to use multiple resources in concert.</p><p>Take a look at this example from a profile for use in AWS virtual machines. We use the <code>command</code> resource to run the <code>find</code> command and then use the <code>file</code> resource to investigate each result. Using multiple resources together is one of the key values InSpec provides, allowing you to get at just the data you need when you need it.</p><div class="language-ruby line-numbers-mode" data-ext="rb"><pre class="language-ruby"><code>command<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;find ~/* -type f -maxdepth 0 -xdev&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>split<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>fname<span class="token operator">|</span>  <span class="token comment"># we need to be careful about using &#39;find&#39; --</span>
                                                                            <span class="token comment"># there could be a LOT of output if we are not specific enough with the search!</span>
  describe file<span class="token punctuation">(</span>fname<span class="token punctuation">)</span> <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;owner&#39;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token string-literal"><span class="token string">&#39;ec2-user&#39;</span></span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">Avoid Large Sets or &#39;Check Everyone at the Door&#39; Approaches</p><p>For IO intensive (full filesystem, or global scans) or large scale processes, try to be as specific as possible with your searches. Think about using &#39;negative logic&#39; vs &#39;positive logic&#39; - &quot;Find me all the items outside my target set&quot; vs &quot;Look at each item in the set and ensure it has these properties&quot;.</p><p>This &#39;find the outsiders&#39; vs &#39;check everyone at the door&#39; approach can really speed things along. Again, keep your data set as small as possible, don&#39;t inspect more than the requirements require!</p></div></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/courses/beginner/07.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a aria-label="6. Inputs in InSpec" class="vp-link nav-link prev nav-link prev" href="/saf-training-current/courses/beginner/06.html"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->6. Inputs in InSpec</div></a><a aria-label="8. Generating InSpec Results" class="vp-link nav-link next nav-link next" href="/saf-training-current/courses/beginner/08.html"><div class="hint">Next<span class="arrow end"></span></div><div class="link">8. Generating InSpec Results<!----></div></a></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Apache-2.0 | Copyright © 2022 - The MITRE Corporation</div><div class="vp-copyright">Copyright © 2024 Aaron Lippold</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/saf-training-current/assets/app-WeARUK1X.js" defer></script>
  </body>
</html>
